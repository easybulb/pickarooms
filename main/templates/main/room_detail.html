{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/room_detail.css' %}">
{% endblock %}

{% block title %}{{ room.name }} - Room Details{% endblock %}

{% block content %}

<!-- âœ… Hero Section with Image and Playable Video -->
<section class="room-hero">
    <div class="hero-overlay"></div>

    <!-- âœ… Default Room Image -->
    <div class="room-hero-content">
        <img src="{{ image_url }}" alt="{{ room.name }}" class="room-hero-image" id="heroImage">
        <button class="play-button" id="playVideo">
            <i class="fas fa-play"></i>
        </button>
        <p class="play-text" style="font-weight: 400;">Instruction Video</p>  <!-- âœ… Play Video Text -->
    </div>

    <!-- âœ… Hidden Video (Revealed on Click) -->
    <div class="room-video-container" id="videoContainer" style="display: none;">
        <iframe id="videoFrame" src="{{ room.video_url }}" title="Room Instructions"
                frameborder="0" allow="autoplay; encrypted-media; picture-in-picture" allowfullscreen>
        </iframe>
    </div>
</section>

<!-- âœ… Room Name & Guest Info -->
<section class="room-header">
    <h1>{{ room.name }}</h1>
    {% if guest %}
        <p>Welcome, {{ guest.full_name }}</p>
    {% endif %}
</section>


<!-- âœ… Room Details -->
<section class="room-container">
    <div class="room-info">
        <h2>ğŸ”‘ House & Room Access PIN</h2>
        {% if not show_pin %}
            <p class="pin-wait">Check-in starts at 2 PM UK time. Your PIN will be available then.</p>
        {% else %}
            <p class="pin-code">{{ room.access_pin|default:"No PIN assigned yet. Contact support." }}</p>
        {% endif %}
    
        <h2>ğŸ›ï¸ Room Details</h2>
        <p>{{ room.description }}</p>

        {% if guest %}
        <h2>ğŸ“… Your Stay</h2>
        <p><strong>Reservation Number:</strong> {{ guest.reservation_number }}</p>
        <p><strong>Check-In:</strong> {{ guest.check_in_date }} (From 2 PM)</p>
        <p><strong>Check-Out:</strong> {{ guest.check_out_date }} (Before 11 AM)</p>
        <p class="expiration"><strong>Access Expires:</strong> {{ expiration_message }}</p>
        {% else %}
        <p class="no-guest">âŒ No guest assigned to this room. Contact admin for assistance.</p>
        {% endif %}
    </div>
<br>
<!-- âœ… FAQ Section -->
<div id="faq" class="room-info">
    <h2>â“ Frequently Asked Questions</h2>
    <div class="faq-container">

        <!-- âœ… House Address -->
        <div class="faq-item">
            <button class="faq-question">ğŸ“ Where is the property located? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p><strong>8 Rylance Street, Beswick, Manchester, M11 3NP</strong></p>
                <p>
                    <a href="https://maps.google.com?q=8+Rylance+Street,+M11+3NP" target="_blank">
                        ğŸ“ Open in Google Maps
                    </a>
                </p>
                <img src="https://res.cloudinary.com/dkqpb7vwr/image/upload/v1739857805/property-image_jvfznl.png" 
                alt="Street View of Property" 
                class="street-image">
            </div>
        </div>

        <!-- âœ… Directions to Property -->
        <div class="faq-item">
            <button class="faq-question">How do I get to the property? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p><strong>Coming from Manchester Airport?</strong></p>
                <ul>
                    <li>ğŸš• <strong>Taxi:</strong> A direct taxi from <strong>Manchester Airport</strong> takes approximately 25 minutes.</li>
                    <li>ğŸš† <strong>Train:</strong> Take a train from <strong>Manchester Airport to Piccadilly Station</strong>, then a short <strong>Â£5 taxi ride</strong> to the property.</li>
                    <li>ğŸšŒ <strong>Bus:</strong> The <strong>219 bus</strong> from <strong>Piccadilly Station</strong> stops near the property.</li>
                </ul>

                <p><strong>Coming from another part of Manchester?</strong></p>
                <p>Make your way to <strong>Manchester city centre</strong> and take the <strong>219 bus</strong> to the nearest bus stop close to the property. You can use <strong>Google Maps</strong> or your navigation app to find the closest stop to alight.</p>

                <p><strong>Driving to the property?</strong></p>
                <p>Use <strong>Google Maps</strong> or your preferred navigation app and enter the destination:</p>
                <p><strong>8 Rylance Street, Beswick, Manchester, M11 3NP</strong></p>
                <p>The property is easily accessible via <strong>Ashton Old Road (A635)</strong>. If coming from the <strong>M60 motorway</strong>, take Exit 24 and follow signs toward <strong>Manchester City Centre</strong>. Parking is available on-site.</p>
            </div>
        </div>


        <div class="faq-item">
            <button class="faq-question">How do I use the PIN? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <ol>
                    <li>Watch the video at the top of this page for easy instructions.</li>
                    <li>When you arrive at the propertyâ€™s front door, touch the keypad area to light up the numbers.</li>
                    <li>Enter your PIN: 
                        {% if not show_pin %}
                            <p class="pin-wait">Check-in starts at 2 PM UK time. Your PIN will be available then.</p>
                        {% else %}
                            <p class="pin-code">{{ room.access_pin|default:"No PIN assigned yet. Contact support." }}</p>
                        {% endif %}
                    </li>
                    <li>Once inside, <strong>remove your shoes</strong> and make your way upstairs to find <strong>{{ room.name }}</strong>.</li>
                    <li>Touch the front of the {{ room.name }} door lock to light up the numbers and enter the same PIN to access your room.</li>
                    <li>Inside your room, you will find a <strong>keycard</strong>. You can either continue using your PIN or use the keycard to enter and exit the property and your room. Watch the video above on how to use the keycard.</li>
                </ol>
            </div>
        </div>
        
        <!-- âœ… Wifi Password -->
        <div class="faq-item">
            <button class="faq-question">What is the WiFi password? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>The WiFi details are below.</p>
                <ul>
                    <li><strong>Wifi Name:</strong> Guest_2.4G</li>
                    <li><strong>Password:</strong> welcome1</li>
                </ul>  
            </div>
        </div>

        <!-- âœ… House Rules -->
        <div class="faq-item">
            <button class="faq-question">What are the house rules? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <ul>
                    <li>â— No smoking inside.</li>
                    <li>ğŸ”‘ Lost keys incur a fee.</li>
                    <li>ğŸ‰ No loud noise or parties allowed.</li>
                </ul>
            </div>
        </div>

        <!-- âœ… Kitchen Info -->
        <div class="faq-item">
            <button class="faq-question">Where is the shared kitchen? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>ğŸ• The kitchen is located downstairs and you have full access to it.</p>
                <p>ğŸ• <strong>Microwave & Oven:</strong> Located in the kitchen. Instructions are available nearby.</p>
                <p>ğŸ½ <strong>Plates & Cutlery:</strong> Stored in the cabinets. Please wash after use.</p>
            </div>
        </div>

        <!-- âœ… Heating Instructions -->
        <div class="faq-item">
            <button class="faq-question">How do I adjust the heating? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>â„ï¸ To increase the heat, turn both radiator knobs <strong>anti-clockwise</strong> to allow hot water to flow in.</p>
                <p>ğŸ”¥ The heating system will automatically activate when the room temperature drops below <strong>21Â°C</strong>.</p>
                <p>âš ï¸ <strong>Note:</strong> Do not force the knobs. If they feel stiff, turn them gently.</p>
            </div>
        </div>


        <!-- âœ… Transport and Taxi Services -->
        <div class="faq-item">
            <button class="faq-question">How can I get around? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>ğŸš• <stong>Recommended Taxi:</stong> Uber, Bolt, or StreetCars <stong>(+44 161 223 1066)</stong></p>
                <p>ğŸš‡ <stong>Metro:</stong> Take <strong>bus 219 from Ashton-Old-Road</strong> to the city centre.</p>
                <p>For more bus routes and planning go to <a href="https://tfgm.com/" target="blank">Bee Network</a></p>
            </div>
        </div>

        <!-- âœ… Check-Out Instructions -->
        <div class="faq-item">
            <button class="faq-question">How do I check out? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <ul>
                    <li>ğŸ›‘ <strong>Leave the keycard inside the room</strong>â€”anywhere visible.</li>
                    <li>ğŸ”Œ <strong>Switch off all electrical appliances</strong> and ensure lights are turned off.</li>
                    <li>ğŸšª <strong>Close the door securely behind you</strong>.</li>
                    <li>ğŸ›ï¸ <strong>Leave used towels</strong> in the bathroom.</li>
                    <li>ğŸ“… <strong>Housekeeping staff may enter</strong> after the checkout time.</li>
                </ul>
            </div>
        </div>


        <!-- âœ… Parking Info -->
        <div class="faq-item">
            <button class="faq-question">ğŸš˜ Where can I park? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>âœ… <strong>Free parking</strong> is available on the property.</p>
                <p>âœ… The tarmac area can accommodate two cars. If you arrive before other guests, please park <strong>well to the left</strong> to leave enough space for another car to park beside yours.</p>
            </div>
        </div>

        <!-- âœ… Bathroom & Towels -->
        <div class="faq-item">
            <button class="faq-question">Where is the bathroom, and do you provide towels? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>ğŸš¿ <strong>Bathrooms & Toilets:</strong> Some rooms have en-suite bathrooms, while others have shared bathrooms located in the hallway.</p>
                <p>ğŸ› Fresh towels are provided inside your room. Shower gel is also available in the bathroom for your convenience.</p>
            </div>
        </div>


        <!-- âœ… Pressing Iron and Hairdryer -->
        <div class="faq-item">
            <button class="faq-question">Do you provide a pressing iron and hairdryer? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>ğŸ§º Yes, a <strong>pressing iron</strong> is available in the hallway for your use.</p>
                <p>ğŸ’¨ A <strong>hairdryer</strong> can be found in the bathroom.</p>
            </div>
        </div>

        <div class="faq-item">
            <button class="faq-question">How safe is the internet network? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>Our internet is powered by <strong>Fibre One</strong> and secured with an <strong>Eero 6+ Gateway</strong>. The guest network is fully isolated, preventing data sharing between devices.</p>
            </div>
        </div>

        <div class="faq-item">
            <button class="faq-question">Is my digital lock secure? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>The <strong>Tuya Smart Lock</strong> ensures only the assigned guest and admin can access the room. PINs automatically expire after checkout, making it highly secure.</p>
            </div>
        </div>

        <!-- âœ… Room Amenities -->
        <div class="faq-item">
            <button class="faq-question">What amenities are included in the room? <span class="arrow">â–¼</span></button>
            <div class="faq-answer">
                <p>The room includes the following amenities:</p>
                <ul>
                    <li>âœ… Free High-Speed WiFi</li>
                    <li>âœ… Fresh Towels & Bed Linen</li>
                    <li>âœ… Private or Shared Bathroom with body wash and hand wash</li>
                    <li>âœ… Smart TV with Netflix, Amazon Prime and others</li>
                    <li>âœ… Pressing Iron and Hair Dryer</li>
                    <li>âœ… Complimentary Tea, Coffee & Milk (In the kitchen downstairs)</li>
                </ul>  
            </div>
        </div>

    </div>
</div>

<!-- âœ… WhatsApp Chat Button -->
<div id="chat-button"  class="room-info" onclick="toggleChat()">ğŸ’¬ Chat with Me</div>
<div class="chat-box" id="chatBox">
    <p>Need help? Send me a message on WhatsApp!</p>
    <a href="https://wa.me/447539029629" target="_blank">Open WhatsApp</a>
</div>

</section>

<!-- âœ… JavaScript to Control Video and FAQ -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // âœ… Select elements
        const heroImage = document.getElementById("heroImage");
        const videoContainer = document.getElementById("videoContainer");
        const playButton = document.getElementById("playVideo");
        const playText = document.querySelector(".play-text");
        const heroOverlay = document.querySelector(".hero-overlay");
        const iframe = document.getElementById("videoFrame");

        playButton.addEventListener("click", function () {
            // âœ… Hide elements
            heroImage.style.display = "none";
            playButton.style.display = "none";
            playText.style.display = "none";
            heroOverlay.style.display = "none";

            // âœ… Show and autoplay the video
            videoContainer.style.display = "flex";
            let videoSrc = iframe.src;
            if (!videoSrc.includes("autoplay=1")) {
                iframe.src = videoSrc + (videoSrc.includes("?") ? "&" : "?") + "autoplay=1";
            }
        });

        // âœ… FAQ Functionality (Open/Close Answers)
        const faqItems = document.querySelectorAll(".faq-item");

        faqItems.forEach(item => {
            const question = item.querySelector(".faq-question");
            const answer = item.querySelector(".faq-answer");
            const arrow = item.querySelector(".arrow");

            question.addEventListener("click", function () {
                const isActive = answer.style.display === "block";

                // Close all other answers
                faqItems.forEach(faq => {
                    faq.querySelector(".faq-answer").style.display = "none";
                    faq.querySelector(".arrow").textContent = "â–¼";
                });

                // Toggle clicked item
                answer.style.display = isActive ? "none" : "block";
                arrow.textContent = isActive ? "â–¼" : "â–²";
            });
        });

        // âœ… Smooth Scroll Function for Navigation
        window.scrollToSection = function (sectionId) {
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                window.scrollTo({
                    top: targetSection.offsetTop - 20, // Adjust for spacing
                    behavior: "smooth"
                });
            }
        };

        // âœ… Floating Chat Button Functionality
        window.toggleChat = function () {
            document.getElementById("chatBox").classList.toggle("show");
        };
    });
</script>

{% endblock %}
